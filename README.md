# 原料在庫管理システム (Raw Material Inventory Management System)

Flask ベースの原料在庫管理Webアプリケーション

## 主な機能

### 基本機能
- **原料管理**: 原料の登録、編集、削除
- **在庫追跡**: 重量ベースの在庫管理
- **検索・ソート**: 原料名での検索、各種ソート機能
- **低在庫アラート**: 最低量を下回る場合の警告表示
- **CSVエクスポート**: 在庫データのエクスポート

### 予測・予約機能
- **予測在庫計算**: 現在量 + 補充予定 - 使用予定
- **使用予約**: 原料の使用計画を事前登録
- **補充予約**: 原料の補充計画を事前登録
- **スケジュール管理**: 予定日を設定し、期限切れを通知
- **予約実行**: 期限切れの予約を在庫に反映

### ロット管理
- **ロット登録**: 各原料のロット別管理
- **ロット追跡**: 予約時にロットを指定可能
- **重量管理**: ロット別の重量追跡

### レシピ機能
- **レシピ作成**: 複数原料の組み合わせを保存
- **レシピ管理**: 登録済みレシピの編集・削除
- **一括予約**: レシピから複数原料の使用予約を一括作成
- **使用者記録**: 使用者名と目的の記録
- **実績記録**: 予約量と実際の使用量の記録

### ダッシュボード
- **統計表示**: 総在庫品目数、低在庫アラート数、予約合計
- **視覚化**: グラフによる在庫状況の表示
- **リアルタイム更新**: 自動更新機能（5分間隔）
- **アラート一覧**: 低在庫原料の詳細表示
- **予約アクティビティ**: 最近の予約履歴
- **検索・フィルター**: 原料の素早い検索と絞り込み

### バックアップ機能 🆕
- **バックアップ作成**: データベースの手動バックアップ
- **バックアップ復元**: 過去のバックアップからデータを復元
- **バックアップ管理**: バックアップファイルの一覧表示、ダウンロード、削除
- **自動保護**: 復元時に現在のデータを自動バックアップ
- **統計表示**: バックアップの総数、サイズ、日時の表示

## セットアップ

### 1. 依存関係のインストール
```bash
pip install -r requirements.txt
```

### 2. データベースマイグレーション（既存のDBがある場合）
```bash
python migrate_db.py
```

### 3. アプリケーションの起動
```bash
python app.py
```

### 4. ブラウザでアクセス
```
http://127.0.0.1:5000/
```

## ディレクトリ構造

```
在庫管理/
├── app.py                 # メインアプリケーション
├── migrate_db.py          # データベース移行スクリプト
├── requirements.txt       # Python依存パッケージ
├── FEATURES.md           # 機能詳細ドキュメント
├── README.md             # このファイル
├── instance/
│   └── inventory.db      # SQLiteデータベース
├── backups/              # バックアップファイル保存先
└── templates/            # HTMLテンプレート
    ├── index.html
    ├── dashboard.html
    ├── reservations.html
    ├── recipes.html
    ├── backup.html       # バックアップ管理画面
    └── ...
```

## 使用技術

- **フレームワーク**: Flask
- **ORM**: SQLAlchemy
- **フォーム**: Flask-WTF
- **スタイリング**: Bootstrap 5.3.0
- **アイコン**: Bootstrap Icons
- **グラフ**: Chart.js 4.4.0
- **データベース**: SQLite
- **バリデーション**: WTForms, email-validator

## バックアップの推奨事項

1. **定期的なバックアップ**
   - 重要な作業の前には必ずバックアップを作成
   - 週次または月次での定期バックアップを推奨

2. **バックアップの保管**
   - 重要なバックアップはダウンロードして外部に保管
   - 複数世代のバックアップを保持

3. **復元の注意点**
   - 復元操作は慎重に実行（現在のデータが上書きされます）
   - 復元前に自動バックアップが作成されますが、重要な場合は手動でもバックアップを

## セキュリティ

- バックアップファイルには機密データが含まれる可能性があります
- `backups/` ディレクトリは `.gitignore` に追加済み
- 本番環境では適切なアクセス制限を設定してください
