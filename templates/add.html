<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>原料追加</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">新規原料追加</h1>
        <form method="POST" class="w-50">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.name.label(class="form-label") }}
                {{ form.name(class="form-control") }}
            </div>
            <div class="mb-3">
                {{ form.weight.label(class="form-label") }}
                {{ form.weight(class="form-control", step="0.001", placeholder="0") }}
                <small class="form-text text-muted">単位: g（グラム）※空欄の場合は0gで登録されます</small>
            </div>
            <div class="mb-3">
                {{ form.min_weight.label(class="form-label") }}
                {{ form.min_weight(class="form-control", step="0.001") }}
                <small class="form-text text-muted">単位: g（グラム）</small>
            </div>
            <div class="mb-3">
                {{ form.action_type.label(class="form-label") }}
                {{ form.action_type(class="form-select") }}
                <small class="form-text text-muted">低在庫時のアクション方法を選択</small>
            </div>
            <div class="mb-3" id="emailField">
                {{ form.email.label(class="form-label") }}
                {{ form.email(class="form-control", placeholder="example@company.com") }}
                <small class="form-text text-muted">購入担当者のメールアドレス（メール連絡を選択した場合）</small>
            </div>
            <div class="mb-3" id="excelField" style="display: none;">
                {{ form.excel_path.label(class="form-label") }}
                {{ form.excel_path(class="form-control", placeholder="C:\\path\\to\\file.xlsx") }}
                <small class="form-text text-muted">エクセルファイルの絶対パス（エクセルを開くを選択した場合）</small>
            </div>
            {{ form.submit(class="btn btn-primary") }}
        </form>
        <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">在庫に戻る</a>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // アクションタイプに応じてフィールドの表示/非表示を切り替え
        const actionType = document.getElementById('action_type');
        const emailField = document.getElementById('emailField');
        const excelField = document.getElementById('excelField');
        
        function toggleFields() {
            const value = actionType.value;
            emailField.style.display = value === 'email' ? 'block' : 'none';
            excelField.style.display = value === 'excel' ? 'block' : 'none';
        }
        
        actionType.addEventListener('change', toggleFields);
        toggleFields(); // 初期表示
    </script>
</body>
</html>
